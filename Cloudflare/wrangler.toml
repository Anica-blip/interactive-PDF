# Cloudflare Worker Configuration for Interactive PDF Builder API
# USES EXISTING INFRASTRUCTURE - Same bucket as library
# Deploy to api.3c-public-library.org for consistency

name = "interactive-pdf-api"
main = "worker.js"
compatibility_date = "2024-01-01"

# R2 Bucket Binding - SHARED with library
[[r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "3c-library-files"

# Environment Variables
[vars]
R2_PUBLIC_URL = "https://files.3c-public-library.org"
ENVIRONMENT = "production"

# Routes - Worker API at api.3c-public-library.org/pdf/*
# Matches SETUP.md infrastructure exactly
[[routes]]
pattern = "api.3c-public-library.org/pdf/*"
zone_name = "3c-public-library.org"

# Note: Supabase credentials set via secrets (not here)
# Run: npx wrangler secret put SUPABASE_URL
# Run: npx wrangler secret put SUPABASE_SERVICE_KEY
# Run: npx wrangler secret put CLOUDFLARE_STREAM_TOKEN
# Run: npx wrangler secret put CLOUDFLARE_ACCOUNT_ID
# Run: npx wrangler secret put CLOUDFLARE_STREAM_SUBDOMAIN

